<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<!--允许全屏-->
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="yes" name="apple-touch-fullscreen" />
<meta content="telephone=no,email=no" name="format-detection" />
<link href="//gw.alicdn.com/tps/i2/TB1nmqyFFXXXXcQbFXXE5jB3XXX-114-114.png" rel="apple-touch-icon-precomposed">
<link href="//gw.alicdn.com/tps/i2/TB1nmqyFFXXXXcQbFXXE5jB3XXX-114-114.png" rel="Shortcut Icon" type="image/x-icon" />
<script src="//g.alicdn.com/mtb/lib-flexible/0.3.2/??flexible.js,flexible_css.js"></script>
<title>Demo - carrouseljs</title>
<style>
    h2 {
        font-size: 1rem;
        text-align: center;
        padding: 0.2rem 0;
    }
</style>
</head>
<body>
<script src="bower_components/lib-gesture/build/gesture.js" type="text/javascript"></script>
<script src="bower_components/lib-cubicbezier/build/cubicbezier.js" type="text/javascript"></script>
<script src="bower_components/lib-animation/build/animation.js" type="text/javascript"></script>
<script src="bower_components/ctrl-indicator/build/indicator.js" type="text/javascript"></script>
<script src="bower_components/ctrl-indicator/build/indicator_css.js" type="text/javascript"></script>
<script src="build/carrousel_css.js" type="text/javascript"></script>
<script src="build/carrousel.debug.js" type="text/javascript"></script>
<h2>大于2张</h2>
<div class="slider" style="height: 3.125rem; width: 10rem; overflow: hidden; position: relative; margin:auto;">
    <ul style="height: 100%;">
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms01.alicdn.com/tps/i1/TB1S1CFGFXXXXaDXXXX7vBfZXXX-1125-352.jpeg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://i.mmcdn.cn/simba/img/TB1zt35GXXXXXbfXVXXSutbFXXX.jpg_q50.jpg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://i.mmcdn.cn/simba/img/T1BZP9FO8XXXb1upjX.jpg_q50.jpg">
        </li>

        <li style="width: 100%; height: 100%">
           <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms02.alicdn.com/tps/i2/TB1tmKhGFXXXXcdXVXXdIns_XXX-1125-352.jpg_q50.jpg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms01.alicdn.com/tps/i1/TB1D.iEGFXXXXbcXFXXdIns_XXX-1125-352.jpg_q50.jpg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms02.alicdn.com/tps/i2/TB1z.KDGFXXXXcrXXXXdIns_XXX-1125-352.jpg_q50.jpg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms02.alicdn.com/tps/i2/TB1AbKEGFXXXXaEXpXXdIns_XXX-1125-352.jpg_q50.jpg">
        </li>
    </ul>
    <div class="indicator" style="width: 16rem; height: 0.45rem; position: absolute; z-index: 3; bottom: 0.4rem; text-align: center;"></div>
</div>
<h2>1张</h2>
<div class="slider" style="height: 3.125rem; width: 10rem; overflow: hidden; position: relative; margin:auto;">
    <ul style="height: 100%;">
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms01.alicdn.com/tps/i1/TB1S1CFGFXXXXaDXXXX7vBfZXXX-1125-352.jpeg">
        </li>
    </ul>
    <div class="indicator" style="width: 16rem; height: 0.45rem; position: absolute; z-index: 3; bottom: 0.4rem; text-align: center;"></div>
</div>
<h2>2张</h2>
<div class="slider" style="height: 3.125rem; width: 10rem; overflow: hidden; position: relative; margin:auto;">
    <ul style="height: 100%;">
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://gtms01.alicdn.com/tps/i1/TB1S1CFGFXXXXaDXXXX7vBfZXXX-1125-352.jpeg">
        </li>
        <li style="width: 100%; height: 100%">
            <img style="width:100%;height:100%;" class="lazyimg" src="http://a.tbcdn.cn/mw/webapp/fav/img/grey.gif" data-src="http://i.mmcdn.cn/simba/img/TB1zt35GXXXXXbfXVXXSutbFXXX.jpg_q50.jpg">
        </li>
    </ul>
    <div class="indicator" style="width: 16rem; height: 0.45rem; position: absolute; z-index: 3; bottom: 0.4rem; text-align: center;"></div>
</div>
<script>
(function() {
    Array.prototype.forEach.call(document.querySelectorAll('.slider'), function(el) {
        var carrousel = new ctrl.carrousel(el.querySelector('ul'), {
            autoplay: true,
            useGesture: true
        });

        var indicator = new ctrl.indicator({
            direction: 'horizontal',
            amount: carrousel.items.length,
            index: 1
        });
        el.querySelector('.indicator').appendChild(indicator.root);

        carrousel.addEventListener('change', function(e) {
            // var index = carrousel.items.index;
            // var items = [carrousel.items.get(index), carrousel.items.get(index + 1)];
            var items = [e.curItem, e.nextItem, e.prevItem];

            items.filter(function(item) {
                return !!item;
            }).map(function(item) {
                return item.querySelector('.lazyimg');
            }).filter(function(el){return !!el}).forEach(function(el) {
                var dataSrc = el.getAttribute('data-src');

                if (dataSrc) {
                    el.src = dataSrc;
                    el.removeAttribute('data-src');
                    el.className = el.className.split(' ').filter(function(c){return c !== 'lazyimg'}).join(' ');
                }
            });

            indicator.index =  e.curItem.index + 1;
        });

        carrousel.play();
    });
})();
</script>
</body>
</html>

